#internship_container.def
Bootstrap: debootstrap
OSVersion: buster
MirrorURL: http://deb.debian.org/debian
Include: vim
%setup
%files
%environment
%runscript
%post
    # update everything
    apt --yes update && apt --yes --force-yes upgrade
    # install tools required for building from source or installation without apt
    apt --yes install build-essential
    apt --yes install gdebi-core
    apt --yes install curl
    apt --yes install wget
    apt --yes install zip
    apt --yes install unzip
    ########################
    # install conda #
    ########################
    wget https://repo.anaconda.com/archive/Anaconda3-2019.07-Linux-x86_64.sh
    bash Anaconda3-2019.07-Linux-x86_64.sh -b -p /opt/anaconda3
    chmod +x /opt/anaconda3/bin/conda
    ln -s /opt/anaconda3/bin/conda /usr/local/bin/conda
    rm Anaconda3-2019.07-Linux-x86_64.sh
    # install python tools
    /opt/anaconda3/bin/conda config --add channels defaults
    /opt/anaconda3/bin/conda config --add channels bioconda
    /opt/anaconda3/bin/conda config --add channels conda-forge
    /opt/anaconda3/bin/conda create -n scanpyenv scanpy=1.8.1 python=3.7
    /opt/anaconda3/bin/conda create -n scvelo_env scvelo=0.2.3 python=3.7
    /opt/anaconda3/bin/conda create -n scrublet_env scrublet=0.2.3 python=3.7
    /opt/anaconda3/bin/conda init bash
    #########################
    # install java tools    #
    #########################
    wget -qO - https://adoptopenjdk.jfrog.io/adoptopenjdk/api/gpg/key/public | apt-key add - # the key for openjdk
    # we need this package to allow adding of repositories
    apt --yes install software-properties-common
    apt --yes update
    # we need to add a repository for this one
    add-apt-repository --yes https://adoptopenjdk.jfrog.io/adoptopenjdk/deb/
    apt --yes update && apt --yes install adoptopenjdk-8-hotspot
    # openjdk 11 however, is in the standard repos
    apt --yes install openjdk-11-jdk
    apt --yes install maven
    apt --yes install git
    git clone https://github.com/molgenis/systemsgenetics.git
    cd ./systemsgenetics
    git checkout 34096bdbaae723d438d9167d962806efeb0b63e1
    # increase memory for maven
    export MAVEN_OPTS="-Xmx4096m -XX:MaxPermSize=4096m"
    # build the projects
    mvn package -DskipTests
    mkdir -p /opt/systemsgenetics/GenotypeHarmonizer/
    cp ./Genotype-Harmonizer/target/GenotypeHarmonizer-1.4.23-SNAPSHOT.jar /opt/systemsgenetics/GenotypeHarmonizer/GenotypeHarmonizer.jar
    echo "#/bin/bash" > /opt/systemsgenetics/GenotypeHarmonizer/GenotypeHarmonizer.sh
    echo "java -jar /opt/systemsgenetics/GenotypeHarmonizer/GenotypeHarmonizer.jar '$@'" >> /opt/systemsgenetics/GenotypeHarmonizer/GenotypeHarmonizer.sh
    chmod +x /opt/systemsgenetics/GenotypeHarmonizer/GenotypeHarmonizer.sh
    ln -s /opt/systemsgenetics/GenotypeHarmonizer/GenotypeHarmonizer.sh /usr/local/bin/GenotypeHarmonizer
    mkdir -p /opt/systemsgenetics/eqtl-mapping-pipeline/
    cp ./eqtl-mapping-pipeline/target/eqtl-mapping-pipeline-1.4.9a-SNAPSHOT.jar /opt/systemsgenetics/eqtl-mapping-pipeline/eqtl-mapping-pipeline.jar
    echo "#/bin/bash" > /opt/systemsgenetics/eqtl-mapping-pipeline/eqtl-mapping-pipeline.sh
    echo "java -jar /opt/systemsgenetics/eqtl-mapping-pipeline/eqtl-mapping-pipeline.jar" '$@'>> /opt/systemsgenetics/eqtl-mapping-pipeline/eqtl-mapping-pipeline.sh
    chmod +x /opt/systemsgenetics/eqtl-mapping-pipeline/eqtl-mapping-pipeline.sh
    ln -s /opt/systemsgenetics/eqtl-mapping-pipeline/qtl-mapping-pipeline.sh /usr/local/bin/qtl-mapping-pipeline
    cd ../
    rm -r systemsgenetics
    #########################
    #   Install python
    #########################
    # pandas
    # import os.path
    # import os
    #import pandas as pd
    # import numpy as np
    ##import io
    #import seaborn as sns
    #import matplotlib.pyplot as plt
    # import glob
    # import mysql.connector
    # mysql-connector-python
    # from numpy.core.numeric import NaN
    # import csv
    # from itertools import combinations
    #import sys
    # import pysam
    apt --yes install python3.7
    apt-get -qq install -y --no-install-recommends \
        python \
        python-pip \
        python-dev \
        python3-dev \
        python3-pip \
        python3-wheel
    # Update python pip.
    python3 -m pip --no-cache-dir install --upgrade pip
    python3 -m pip --no-cache-dir install setuptools --upgrade
    python -m pip --no-cache-dir install setuptools --upgrade
    python3 -m pip --no-cache-dir install os
    python3 -m pip --no-cache-dir install pandas
    python3 -m pip --no-cache-dir install numpy
    python3 -m pip --no-cache-dir install seaborn
    python3 -m pip --no-cache-dir install matplotlib.pyplot
    python3 -m pip --no-cache-dir install glob
    python3 -m pip --no-cache-dir install mysql-connector
    python3 -m pip --no-cache-dir install mysql-connector-python
    python3 -m pip --no-cache-dir install numpy.core.numeric
    python3 -m pip --no-cache-dir install csv
    python3 -m pip --no-cache-dir install itertools
    python3 -m pip --no-cache-dir install pysam

    #########################
    #   BWA
    #########################
    #https://sourceforge.net/projects/bio-bwa/files/
    apt --yes install bwa
    #########################
    #   samtools
    #########################
    #https://sourceforge.net/projects/samtools/files/samtools/1.13/
    apt --yes install samtools
    #########################
    #   Picard - #https://gatk.broadinstitute.org/hc/en-us/articles/360041320571--How-to-Install-all-software-packages-required-to-follow-the-GATK-Best-Practices
    #########################
    #https://github.com/broadinstitute/picard/releases/
    wget https://github.com/broadinstitute/picard/releases/download/2.26.3/picard.jar
    # apt-get --yes install openjdk
    #apt-get install openjdk-8-jre-headless
    mkdir /opt/picard
    # copy to opt (were more apps are installed)
    cp picard.jar /opt/picard/
    #nano /opt/picard/picard.sh
    echo "#!/bin/bash" > /opt/picard/picard.sh
    echo 'java -jar /opt/picard/picard.jar "$@"' >> /opt/picard/picard.sh
    chmod +x /opt/picard/picard.sh
    # symlink so available from anywhere in terminal
    ln -s /opt/picard/picard.sh /usr/local/bin/picard
    #########################
    #   GATK - #https://gatk.broadinstitute.org/hc/en-us/articles/360041320571--How-to-Install-all-software-packages-required-to-follow-the-GATK-Best-Practices
    #########################
    wget https://github.com/broadinstitute/gatk/releases/download/4.2.2.0/gatk-4.2.2.0.zip
    # unzip
    unzip gatk-4.2.2.0.zip
    # rename to basename
    mv gatk-4.2.2.0 gatk
    # copy to opt (were more apps are installed)
    cp -r gatk /opt/
    # make executable
    chmod +x /opt/gatk/gatk
    # symlink so available from anywhere in terminal
    ln -s /opt/gatk/gatk /usr/local/bin/gatk
    #########################
    #   bowtie2
    #########################
    #https://zoomadmin.com/HowToInstall/UbuntuPackage/bowtie2
    apt --yes install bowtie2
    #########################
    #   fastqc
    #########################
    apt --yes install fastqc
    #########################
    #   cutadapt
    #########################
    #https://cutadapt.readthedocs.io/en/stable/installation.html
    apt --yes install cutadapt
    #########################
    #   bcftools
    #########################
    apt --yes install bcftools
    #########################
    # fastx https://bioinformaticsreview.com/20201109/installing-fastx-toolkit-on-ubuntu/
    #########################
    mkdir fastx_toolkit
    cd fastx_toolkit/
    wget http://hannonlab.cshl.edu/fastx_toolkit/fastx_toolkit_0.0.13_binaries_Linux_2.6_amd64.tar.bz2
    tar -xf fastx_toolkit_0.0.13_binaries_Linux_2.6_amd64.tar.bz2
    rm fastx_toolkit_0.0.13_binaries_Linux_2.6_amd64.tar.bz2
    chmod +x ./bin/*
    cd ../
    cp -r fastx_toolkit /opt
    ln -s /opt/fastx_toolkit/bin/* /usr/local/bin/
    ########################
    # # install R: https://docs.rstudio.com/resources/install-r/#optional-install-recommended-packages
    ########################
    export R_VERSION=4.1.2
    curl -O https://cdn.rstudio.com/r/debian-10/pkgs/r-${R_VERSION}_1_amd64.deb
    gdebi -n r-${R_VERSION}_1_amd64.deb
    ln -s /opt/R/${R_VERSION}/bin/R /usr/local/bin/R
    ln -s /opt/R/${R_VERSION}/bin/Rscript /usr/local/bin/Rscript
    #########################
    # install R libraries   #
    #########################
    # karyoploteR
    # "chromPlot"
    # chromoMap
    # data.table

    # set file where we will log the installation info
    touch ./r_lib_install_log.txt
    # set the repo
    echo 'local({r <- getOption("repos");r["CRAN"] <- "https://mirror.lyrahosting.com/";options(repos = r)})' > ~/Rprofile.site
    # first install biocmanager and remotes
    R --slave -e 'install.packages(c("BiocManager", "remotes"), repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    # some other stuff
    R --slave -e 'BiocManager::install("BiocGenerics")' >> ./r_lib_install_log.txt
    R --slave -e 'BiocManager::install("Biobase")' >> ./r_lib_install_log.txt
    # which allows us to install devtools
    R --slave -e 'remotes::install_version("rversions", "2.1.1", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("roxygen2", "7.1.1", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'BiocManager::install(c("devtools"))' >> ./r_lib_install_log.txt
    # which allows us to install specific versions of software
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/multtest_2.48.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("data.table", "1.14.0", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("ggplot2", "3.3.5", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("ggpubr", "0.4.0", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("Matrix", "1.3-4", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("Matrix.utils", "0.9.8", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("metap", "1.4", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("stringr", "1.4.0", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("RColorBrewer", "1.1-2", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("VennDiagram", "1.6.20", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("Rcpp", "1.0.7", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("foreach", "1.5.1", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("doMC", "1.3.7", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("gridExtra", "2.3", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("lattice", "0.20-44", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("plyr", "1.8.6", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("dplyr", "1.0.7", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("UpSetR", "1.4.0", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("scales", "1.1.1", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("broom", "0.7.9", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("tidyverse", "1.3.1", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/MatrixGenerics_1.4.3.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("MatrixEQTL", "2.3", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/S4Vectors_0.30.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/IRanges_2.26.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("RCurl", "1.98-1.3", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/data/annotation/src/contrib/GenomeInfoDbData_1.2.6.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/GenomeInfoDb_1.28.2.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/zlibbioc_1.38.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/XVector_0.32.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/GenomicRanges_1.44.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    #R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/MatrixGenerics_1.4.3.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("metafor", "3.0-2", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/topconfects_1.8.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("plotly", "4.9.4.1", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("htmlwidgets", "1.5.3", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/MetaVolcanoR_1.6.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/Biostrings_2.60.2.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("snow", "0.4-3", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("BH", "1.75.0-0", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/BiocParallel_1.26.2.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/Rhtslib_1.24.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/Rsamtools_2.8.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("RSQLite", "2.2.7", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("png", "0.1-7", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/KEGGREST_1.32.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/AnnotationDbi_1.54.1.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("XML", "3.99-0.6", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/GenomicAlignments_1.28.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/BiocIO_1.2.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("restfulr", "0.0.13", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/rtracklayer_1.52.1.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/BSgenome_1.60.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("filelock", "1.0.2", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/BiocFileCache_2.0.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/biomaRt_2.48.3.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/GenomicFeatures_1.44.2.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/VariantAnnotation_1.38.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    #R --slave -e 'remotes::install_version("hdf5r", "1.3.3", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    #R --slave -e 'remotes::install_version("hdf5r", "1.3.3", repos="https://mirror.lyrahosting.com/CRAN/", build_opts=c("--no-resave-data", "--no-manual", "--no-build-vignettes", "--with-hdf5=/usr/local/hdf5/bin/h5cc"))'
    # this package is a nightmare
    #wget https://cran.r-project.org/src/contrib/Archive/hdf5r/hdf5r_1.3.2.tar.gz
    #R --slave -e 'install.packages("./hdf5r_1.3.2.tar.gz")' ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("hdf5r", "1.3.2", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("Seurat", "4.0.3", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'devtools::install_github("thomasp85/patchwork@v1.1.0")' ./r_lib_install_log.txt
    R --slave -e 'devtools::install_github("mojaveazure/seurat-disk", ref="163f1aade5bac38ed1e9e9c912283a7e74781610")' ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("harmony", "0.1.0", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'devtools::install_github("JinmiaoChenLab/Rphenograph", ref="0298487f0ee13aac55eb77d19992f6bd878ba2fc")' ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("systemfonts", "1.0.2", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("svglite", "2.0.0", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("clue", "0.3-59", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("GetoptLong", "1.0.5", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("Cairo", "1.5-12.2", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("circlize", "0.4.13", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("doParallel", "1.0.16", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/ComplexHeatmap_2.8.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/DelayedArray_0.18.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/SummarizedExperiment_1.22.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/SingleCellExperiment_1.14.1.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/MAST_1.18.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/limma_3.48.3.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/GenomicAlignments_1.28.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/BiocIO_1.2.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("restfulr", "0.0.13", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/rtracklayer_1.52.1.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/BSgenome_1.60.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("filelock", "1.0.2", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/BiocFileCache_2.0.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/biomaRt_2.48.3.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/GenomicFeatures_1.44.2.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/VariantAnnotation_1.38.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'devtools::install_github("sqjin/CellChat", ref="eb959d5fc45df9920116f90644fe0b5e155e304b")' ./r_lib_install_log.txt
    R --slave -e 'devtools::install_github("saeyslab/nichenetr", ref="2136a7260fbbe9ef5e9b4af0fd4c9101a3bc9a78")' ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://bioconductor.org/packages/release/bioc/src/contrib/KEGGREST_1.32.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://bioconductor.org/packages/release/bioc/src/contrib/AnnotationDbi_1.54.1.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://bioconductor.org/packages/release/bioc/src/contrib/annotate_1.70.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://bioconductor.org/packages/release/bioc/src/contrib/genefilter_1.74.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("locfit", "1.5-9.4", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://bioconductor.org/packages/release/bioc/src/contrib/geneplotter_1.70.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://bioconductor.org/packages/release/bioc/src/contrib/DESeq2_1.32.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://www.bioconductor.org/packages/release/bioc/src/contrib/pcaMethods_1.84.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'devtools::install_github("velocyto-team/velocyto.R", ref="83e6ed92c2d9c9640122dcebf8ebbb5788165a21")' ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://bioconductor.org/packages/release/bioc/src/contrib/sparseMatrixStats_1.4.2.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://bioconductor.org/packages/release/bioc/src/contrib/DelayedMatrixStats_1.14.3.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("RcppHNSW", "0.3.0", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://bioconductor.org/packages/release/bioc/src/contrib/BiocNeighbors_1.10.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'remotes::install_version("rsvd", "1.0.5", repos="https://mirror.lyrahosting.com/CRAN/")' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://bioconductor.org/packages/release/bioc/src/contrib/ScaledMatrix_1.0.0.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://bioconductor.org/packages/release/bioc/src/contrib/beachmat_2.8.1.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://bioconductor.org/packages/release/bioc/src/contrib/BiocSingular_1.8.1.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'install.packages("https://bioconductor.org/packages/release/bioc/src/contrib/SingleR_1.6.1.tar.gz", repos=NULL)' >> ./r_lib_install_log.txt
    R --slave -e 'devtools::install_github("carmonalab/UCell", ref="9f70daa5ce82ffb2fca4fb1599d939bf03eba9fe")' ./r_lib_install_log.txt
    #R --slave -e 'devtools::install_github("leeshawn/MetaSKAT", ref="c0b63c1961a8d772842d4a5004330d273a8aeb43")' ./r_lib_install_log.txt
    #R --slave -e 'devtools::install_github("weizhouUMICH/SAIGE", ref="648850f38ed8f2d187af6a0587cb078fa3233ec6")' ./r_lib_install_log.txt
    # check specifically for URL issues
    grep URL ./r_lib_install_log.txt
    # then remove the file
    rm ./r_lib_install_log.txt
    # check if everything could be loaded
    echo '
    library(Seurat)
    library(MAST)
    library(limma)
    library(DESeq2)
    library(VariantAnnotation)
    library(CellChat)
    library(nichenetr)
    library(velocyto.R)
    library(harmony)
    library(MatrixEQTL)
    library(Rphenograph)
    library(UCell)
    library(SingleR)
    ' > library_check.R
    # if this script fails then the installation of one of the R libraries failed
    Rscript ./library_check.R
    # clean up
    rm library_check.R